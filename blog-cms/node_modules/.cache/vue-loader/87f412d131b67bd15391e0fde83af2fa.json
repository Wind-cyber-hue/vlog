{"remainingRequest":"/Users/cm/Blog/blog-cms/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/cm/Blog/blog-cms/src/views/blog/blog/WriteBlog.vue?vue&type=style&index=0&id=00baa937&scoped=true&lang=css&","dependencies":[{"path":"/Users/cm/Blog/blog-cms/src/views/blog/blog/WriteBlog.vue","mtime":1683690398266},{"path":"/Users/cm/Blog/blog-cms/node_modules/css-loader/dist/cjs.js","mtime":1683698845853},{"path":"/Users/cm/Blog/blog-cms/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1683698847049},{"path":"/Users/cm/Blog/blog-cms/node_modules/postcss-loader/src/index.js","mtime":1683698846079},{"path":"/Users/cm/Blog/blog-cms/node_modules/cache-loader/dist/cjs.js","mtime":1683698845457},{"path":"/Users/cm/Blog/blog-cms/node_modules/vue-loader/lib/index.js","mtime":1683698847009}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKQGltcG9ydCAifnZkaXRvci9kaXN0L2luZGV4LmNzcyI7Cg=="},{"version":3,"sources":["WriteBlog.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0RA","file":"WriteBlog.vue","sourceRoot":"src/views/blog/blog","sourcesContent":["<template>\n\t<div>\n\t\t<!--面包屑导航-->\n\t\t<Breadcrumb parentTitle=\"博客管理\"/>\n\n\t\t<el-form :model=\"form\" :rules=\"formRules\" ref=\"formRef\" label-position=\"top\">\n\t\t\t<el-row :gutter=\"20\">\n\t\t\t\t<el-col :span=\"12\">\n\t\t\t\t\t<el-form-item label=\"标题\" prop=\"title\">\n\t\t\t\t\t\t<el-input v-model=\"form.title\" placeholder=\"请输入标题\"></el-input>\n\t\t\t\t\t</el-form-item>\n\t\t\t\t</el-col>\n\t\t\t\t<el-col :span=\"12\">\n\t\t\t\t\t<el-form-item label=\"封面图\" prop=\"firstPicture\">\n\t\t\t\t\t\t<el-input v-model=\"form.firstPicture\" placeholder=\"可不填，随机获取\"></el-input>\n\t\t\t\t\t</el-form-item>\n\t\t\t\t</el-col>\n\t\t\t</el-row>\n\n\t\t\t<!-- <el-alert title=\"注意：如果从 Typora 中复制 Markdown，粘贴时要选择粘贴为纯文本，否则代码块可能无法被 prismjs 高亮\" type=\"warning\" center show-icon></el-alert> -->\n\n\t\t\t<el-form-item label=\"描述\" prop=\"description\">\n\t\t\t\t<div id=\"vditor-description\"></div>\n\t\t\t</el-form-item>\n\n\t\t\t<el-form-item label=\"正文\" prop=\"content\">\n\t\t\t\t<div id=\"vditor-content\"></div>\n\t\t\t</el-form-item>\n\n\t\t\t<el-row :gutter=\"20\">\n\t\t\t\t<el-col :span=\"12\">\n\t\t\t\t\t<el-form-item label=\"分类\" prop=\"cate\">\n\t\t\t\t\t\t<el-select v-model=\"form.cate\" placeholder=\"请选择分类（输入可添加新分类）\" :allow-create=\"true\" :filterable=\"true\" style=\"width: 100%;\">\n\t\t\t\t\t\t\t<el-option :label=\"item.name\" :value=\"item.id\" v-for=\"item in categoryList\" :key=\"item.id\"></el-option>\n\t\t\t\t\t\t</el-select>\n\t\t\t\t\t</el-form-item>\n\t\t\t\t</el-col>\n\t\t\t\t<el-col :span=\"12\">\n\t\t\t\t\t<el-form-item label=\"标签\" prop=\"tagList\">\n\t\t\t\t\t\t<el-select v-model=\"form.tagList\" placeholder=\"请选择标签（输入可添加新标签）\" :allow-create=\"true\" :filterable=\"true\" :multiple=\"true\" style=\"width: 100%;\">\n\t\t\t\t\t\t\t<el-option :label=\"item.name\" :value=\"item.id\" v-for=\"item in tagList\" :key=\"item.id\"></el-option>\n\t\t\t\t\t\t</el-select>\n\t\t\t\t\t</el-form-item>\n\t\t\t\t</el-col>\n\t\t\t</el-row>\n\n\t\t\t<el-form-item label=\"浏览次数\" prop=\"views\">\n\t\t\t\t<el-input v-model=\"form.views\" placeholder=\"文章访问量（默认为 0）\" type=\"number\" style=\"width: 50%;\"></el-input>\n\t\t\t</el-form-item>\n\n\t\t\t<el-form-item style=\"text-align: right;\">\n\t\t\t\t<el-button type=\"primary\" @click=\"dialogVisible=true\">保存</el-button>\n\t\t\t</el-form-item>\n\t\t</el-form>\n\n\t\t<!--编辑可见性状态对话框-->\n\t\t<el-dialog title=\"博客可见性\" width=\"30%\" :visible.sync=\"dialogVisible\">\n\t\t\t<!--内容主体-->\n\t\t\t<el-form label-width=\"50px\" @submit.native.prevent>\n\t\t\t\t<el-form-item>\n\t\t\t\t\t<el-radio-group v-model=\"radio\">\n\t\t\t\t\t\t<el-radio :label=\"1\">公开</el-radio>\n\t\t\t\t\t\t<el-radio :label=\"2\">私密</el-radio>\n\t\t\t\t\t\t<el-radio :label=\"3\">密码保护</el-radio>\n\t\t\t\t\t</el-radio-group>\n\t\t\t\t</el-form-item>\n\t\t\t\t<el-form-item label=\"密码\" v-if=\"radio===3\">\n\t\t\t\t\t<el-input v-model=\"form.password\"></el-input>\n\t\t\t\t</el-form-item>\n\t\t\t\t<el-form-item v-if=\"radio!==2\">\n\t\t\t\t\t<el-row>\n\t\t\t\t\t\t<el-col :span=\"6\">\n\t\t\t\t\t\t\t<el-switch v-model=\"form.appreciation\" active-text=\"赞赏\"></el-switch>\n\t\t\t\t\t\t</el-col>\n\t\t\t\t\t\t<el-col :span=\"6\">\n\t\t\t\t\t\t\t<el-switch v-model=\"form.recommend\" active-text=\"推荐\"></el-switch>\n\t\t\t\t\t\t</el-col>\n\t\t\t\t\t\t<el-col :span=\"6\">\n\t\t\t\t\t\t\t<el-switch v-model=\"form.commentEnabled\" active-text=\"评论\"></el-switch>\n\t\t\t\t\t\t</el-col>\n\t\t\t\t\t\t<el-col :span=\"6\">\n\t\t\t\t\t\t\t<el-switch v-model=\"form.top\" active-text=\"置顶\"></el-switch>\n\t\t\t\t\t\t</el-col>\n\t\t\t\t\t</el-row>\n\t\t\t\t</el-form-item>\n\t\t\t</el-form>\n\t\t\t<!--底部-->\n\t\t\t<span slot=\"footer\">\n\t\t\t\t<el-button @click=\"dialogVisible=false\">取 消</el-button>\n\t\t\t\t<el-button type=\"primary\" @click=\"submit\">保存</el-button>\n\t\t\t</span>\n\t\t</el-dialog>\n\t</div>\n</template>\n\n<script>\n\timport Breadcrumb from \"@/components/Breadcrumb\";\n\timport {getCategoryAndTag, saveBlog, getBlogById, updateBlog} from '@/api/blog'\n\timport Vditor from 'vditor'\n\n\texport default {\n\t\tname: \"WriteBlog\",\n\t\tcomponents: {Breadcrumb},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tready: false,\n\t\t\t\tdescriptionVditor: null,\n\t\t\t\tcontentVditor: null,\n\t\t\t\tcategoryList: [],\n\t\t\t\ttagList: [],\n\t\t\t\tdialogVisible: false,\n\t\t\t\tradio: 1,\n\t\t\t\tform: {\n\t\t\t\t\ttitle: '',\n\t\t\t\t\tfirstPicture: '',\n\t\t\t\t\tdescription: '',\n\t\t\t\t\tcontent: '',\n\t\t\t\t\tcate: null,\n\t\t\t\t\ttagList: [],\n\t\t\t\t\twords: null,\n\t\t\t\t\treadTime: null,\n\t\t\t\t\tviews: 0,\n\t\t\t\t\tappreciation: false,\n\t\t\t\t\trecommend: false,\n\t\t\t\t\tcommentEnabled: false,\n\t\t\t\t\ttop: false,\n\t\t\t\t\tpublished: false,\n\t\t\t\t\tpassword: '',\n\t\t\t\t},\n\t\t\t\tformRules: {\n\t\t\t\t\ttitle: [{required: true, message: '请输入标题', trigger: 'change'}],\n\t\t\t\t\t//firstPicture: [{required: true, message: '请输入首图链接', trigger: 'change'}],\n\t\t\t\t\tcate: [{required: true, message: '请选择分类', trigger: 'change'}],\n\t\t\t\t\t// tagList: [{required: true, message: '请选择标签', trigger: 'change'}],\n\t\t\t\t},\n\t\t\t}\n\t\t},\n\t\tcreated() {\n\t\t\tthis.getData()\n\t\t},\n\t\tmounted() {\n\t\t\tthis.initDescriptionVditor()\n\t\t\tthis.initContentVditor()\n\t\t},\n\t\tmethods: {\n\t\t\t//初始化md编辑器\n\t\t\tinitDescriptionVditor() {\n\t\t\t\tconst options = {\n\t\t\t\t\theight: 320,\n\t\t\t\t\tmode: 'sv',//分屏渲染\n\t\t\t\t\toutline: true,//大纲\n\t\t\t\t\tcache: {//不缓存到localStorage\n\t\t\t\t\t\tenable: false,\n\t\t\t\t\t},\n\t\t\t\t\tresize: {//可调整高度\n\t\t\t\t\t\tenable: true\n\t\t\t\t\t},\n\t\t\t\t\tafter: () => {\n\t\t\t\t\t\tif (!this.ready) {\n\t\t\t\t\t\t\tthis.ready = true //两个编辑器都加载完成后执行，避免重复请求\n\t\t\t\t\t\t} else if (this.$route.params.id) {\n\t\t\t\t\t\t\tthis.getBlog(this.$route.params.id)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.descriptionVditor = new Vditor('vditor-description', options)\n\t\t\t},\n\t\t\tinitContentVditor() {\n\t\t\t\tconst options = {\n\t\t\t\t\theight: 640,\n\t\t\t\t\tmode: 'sv',//分屏渲染\n\t\t\t\t\toutline: true,//大纲\n\t\t\t\t\tcache: {//不缓存到localStorage\n\t\t\t\t\t\tenable: false,\n\t\t\t\t\t},\n\t\t\t\t\tresize: {//可调整高度\n\t\t\t\t\t\tenable: true\n\t\t\t\t\t},\n\t\t\t\t\tafter: () => {\n\t\t\t\t\t\tif (!this.ready) {\n\t\t\t\t\t\t\tthis.ready = true\n\t\t\t\t\t\t} else if (this.$route.params.id) {\n\t\t\t\t\t\t\tthis.getBlog(this.$route.params.id)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.contentVditor = new Vditor('vditor-content', options)\n\t\t\t},\n\t\t\tgetBlog(id) {\n\t\t\t\t//编辑博客\n\t\t\t\tgetBlogById(id).then(res => {\n\t\t\t\t\tif (res.code === 200) {\n\t\t\t\t\t\tthis.computeCategoryAndTag(res.data)\n\t\t\t\t\t\t// this.msgSuccess(res.msg);\n\t\t\t\t\t\tthis.form = res.data\n\t\t\t\t\t\tthis.descriptionVditor.setValue(this.form.description)\n\t\t\t\t\t\tthis.contentVditor.setValue(this.form.content)\n\t\t\t\t\t\tthis.radio = this.form.published ? (this.form.password !== '' ? 3 : 1) : 2\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.msgError(res.msg)\n\t\t\t\t\t}\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tthis.msgError('请求失败')\n\t\t\t\t})\n\t\t\t},\n\t\t\tcomputeCategoryAndTag(blog) {\n\t\t\t\tblog.cate = blog.category.id\n\t\t\t\tblog.tagList = []\n\t\t\t\tblog.tags.forEach(item => {\n\t\t\t\t\tblog.tagList.push(item.id)\n\t\t\t\t})\n\t\t\t},\n\t\t\tgetData() {\n\t\t\t\t//获取目录和标签\n\t\t\t\tgetCategoryAndTag().then(res => {\n\t\t\t\t\tif (res.code === 200) {\n\t\t\t\t\t\t// this.msgSuccess(res.msg);\n\t\t\t\t\t\tthis.categoryList = res.data.categories\n\t\t\t\t\t\tthis.tagList = res.data.tags\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.msgError(res.msg)\n\t\t\t\t\t}\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tthis.msgError('请求失败')\n\t\t\t\t})\n\t\t\t},\n\t\t\tsubmit() {\n\t\t\t\tif (this.radio === 3 && (this.form.password === '' || this.form.password === null)) {\n\t\t\t\t\treturn this.msgError(\"密码保护模式必须填写密码！\")\n\t\t\t\t}\n\t\t\t\tthis.$refs.formRef.validate(valid => {\n\t\t\t\t\tif (valid) {\n\t\t\t\t\t\tthis.form.description = this.descriptionVditor.getValue()\n\t\t\t\t\t\tthis.form.content = this.contentVditor.getValue()\n\t\t\t\t\t\tif (this.radio === 2) {\n\t\t\t\t\t\t\tthis.form.appreciation = false\n\t\t\t\t\t\t\tthis.form.recommend = false\n\t\t\t\t\t\t\tthis.form.commentEnabled = false\n\t\t\t\t\t\t\tthis.form.top = false\n\t\t\t\t\t\t\tthis.form.published = false\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.form.published = true\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this.radio !== 3) {\n\t\t\t\t\t\t\tthis.form.password = ''\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this.$route.params.id) {\n\t\t\t\t\t\t\tthis.form.category = null\n\t\t\t\t\t\t\tthis.form.tags = null\n\t\t\t\t\t\t\tupdateBlog(this.form).then(res => {\n\t\t\t\t\t\t\t\tif (res.code === 200) {\n\t\t\t\t\t\t\t\t\tthis.msgSuccess(res.msg)\n\t\t\t\t\t\t\t\t\tthis.$router.push('/blogs')\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tthis.msgError(res.msg)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).catch(() => {\n\t\t\t\t\t\t\t\tthis.msgError('请求失败')\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsaveBlog(this.form).then(res => {\n\t\t\t\t\t\t\t\tif (res.code === 200) {\n\t\t\t\t\t\t\t\t\tthis.msgSuccess(res.msg)\n\t\t\t\t\t\t\t\t\tthis.$router.push('/blogs')\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tthis.msgError(res.msg)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).catch(() => {\n\t\t\t\t\t\t\t\tthis.msgError('请求失败')\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.dialogVisible = false\n\t\t\t\t\t\treturn this.msgError('请填写必要的表单项')\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style scoped>\n\t@import \"~vditor/dist/index.css\";\n</style>"]}]}