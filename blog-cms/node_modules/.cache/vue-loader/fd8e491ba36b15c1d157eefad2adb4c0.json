{"remainingRequest":"/Users/cm/Blog/blog-cms/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/cm/Blog/blog-cms/src/views/blog/moment/WriteMoment.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/cm/Blog/blog-cms/src/views/blog/moment/WriteMoment.vue","mtime":1683690398266},{"path":"/Users/cm/Blog/blog-cms/node_modules/cache-loader/dist/cjs.js","mtime":1683698845457},{"path":"/Users/cm/Blog/blog-cms/node_modules/babel-loader/lib/index.js","mtime":1683698845760},{"path":"/Users/cm/Blog/blog-cms/node_modules/cache-loader/dist/cjs.js","mtime":1683698845457},{"path":"/Users/cm/Blog/blog-cms/node_modules/vue-loader/lib/index.js","mtime":1683698847009}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBCcmVhZGNydW1iIGZyb20gIkAvY29tcG9uZW50cy9CcmVhZGNydW1iIjsKaW1wb3J0IHtnZXRNb21lbnRCeUlkLCBzYXZlTW9tZW50LCB1cGRhdGVNb21lbnR9IGZyb20gIkAvYXBpL21vbWVudCI7CmltcG9ydCBWZGl0b3IgZnJvbSAndmRpdG9yJwoKZXhwb3J0IGRlZmF1bHQgewoJbmFtZTogIldyaXRlTW9tZW50IiwKCWNvbXBvbmVudHM6IHtCcmVhZGNydW1ifSwKCWRhdGEoKSB7CgkJcmV0dXJuIHsKCQkJdmRpdG9yOiBudWxsLAoJCQlmb3JtOiB7CgkJCQljb250ZW50OiAnJywKCQkJCWNyZWF0ZVRpbWU6IG51bGwsCgkJCQlsaWtlczogMCwKCQkJCXB1Ymxpc2hlZDogZmFsc2UKCQkJfSwKCQl9Cgl9LAoJbW91bnRlZCgpIHsKCQl0aGlzLmluaXRWZGl0b3IoKQoJfSwKCW1ldGhvZHM6IHsKCQlpbml0VmRpdG9yKCkgewoJCQljb25zdCBvcHRpb25zID0gewoJCQkJaGVpZ2h0OiAzMjAsCgkJCQltb2RlOiAnc3YnLC8v5YiG5bGP5riy5p+TCgkJCQlvdXRsaW5lOiBmYWxzZSwvL+Wkp+e6sgoJCQkJY2FjaGU6IHsvL+S4jee8k+WtmOWIsGxvY2FsU3RvcmFnZQoJCQkJCWVuYWJsZTogZmFsc2UsCgkJCQl9LAoJCQkJcmVzaXplOiB7Ly/lj6/osIPmlbTpq5jluqYKCQkJCQllbmFibGU6IHRydWUKCQkJCX0sCgkJCQlhZnRlcjogKCkgPT4gewoJCQkJCWlmICh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQpIHsKCQkJCQkJdGhpcy5nZXRNb21lbnQodGhpcy4kcm91dGUucGFyYW1zLmlkKQoJCQkJCX0KCQkJCX0KCQkJfQoJCQl0aGlzLnZkaXRvciA9IG5ldyBWZGl0b3IoJ3ZkaXRvcicsIG9wdGlvbnMpCgkJfSwKCQlnZXRNb21lbnQoaWQpIHsKCQkJZ2V0TW9tZW50QnlJZChpZCkudGhlbihyZXMgPT4gewoJCQkJaWYgKHJlcy5jb2RlID09PSAyMDApIHsKCQkJCQl0aGlzLmZvcm0gPSByZXMuZGF0YQoJCQkJCXRoaXMudmRpdG9yLnNldFZhbHVlKHRoaXMuZm9ybS5jb250ZW50KQoJCQkJfSBlbHNlIHsKCQkJCQl0aGlzLm1zZ0Vycm9yKHJlcy5tc2cpCgkJCQl9CgkJCX0pLmNhdGNoKCgpID0+IHsKCQkJCXRoaXMubXNnRXJyb3IoIuivt+axguWksei0pSIpCgkJCX0pCgkJfSwKCQlzdWJtaXQocHVibGlzaGVkKSB7CgkJCXRoaXMuZm9ybS5jb250ZW50ID0gdGhpcy52ZGl0b3IuZ2V0VmFsdWUoKQoJCQl0aGlzLmZvcm0ucHVibGlzaGVkID0gcHVibGlzaGVkCgkJCWlmICh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQpIHsKCQkJCXVwZGF0ZU1vbWVudCh0aGlzLmZvcm0pLnRoZW4ocmVzID0+IHsKCQkJCQlpZiAocmVzLmNvZGUgPT09IDIwMCkgewoJCQkJCQl0aGlzLm1zZ1N1Y2Nlc3MocmVzLm1zZykKCQkJCQkJdGhpcy4kcm91dGVyLnB1c2goJy9tb21lbnRzJykKCQkJCQl9IGVsc2UgewoJCQkJCQl0aGlzLm1zZ0Vycm9yKHJlcy5tc2cpCgkJCQkJfQoJCQkJfSkuY2F0Y2goKCkgPT4gewoJCQkJCXRoaXMubXNnRXJyb3IoJ+ivt+axguWksei0pScpCgkJCQl9KQoJCQl9IGVsc2UgewoJCQkJc2F2ZU1vbWVudCh0aGlzLmZvcm0pLnRoZW4ocmVzID0+IHsKCQkJCQlpZiAocmVzLmNvZGUgPT09IDIwMCkgewoJCQkJCQl0aGlzLm1zZ1N1Y2Nlc3MocmVzLm1zZykKCQkJCQkJdGhpcy4kcm91dGVyLnB1c2goJy9tb21lbnRzJykKCQkJCQl9IGVsc2UgewoJCQkJCQl0aGlzLm1zZ0Vycm9yKHJlcy5tc2cpCgkJCQkJfQoJCQkJfSkuY2F0Y2goKCkgPT4gewoJCQkJCXRoaXMubXNnRXJyb3IoJ+ivt+axguWksei0pScpCgkJCQl9KQoJCQl9CgkJfQoJfQp9Cg=="},{"version":3,"sources":["WriteMoment.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"WriteMoment.vue","sourceRoot":"src/views/blog/moment","sourcesContent":["<template>\n\t<div>\n\t\t<!--面包屑导航-->\n\t\t<Breadcrumb parentTitle=\"博客管理\"/>\n\n\t\t<el-form :model=\"form\" label-position=\"top\">\n\t\t\t<el-form-item label=\"动态内容\" prop=\"content\">\n\t\t\t\t<div id=\"vditor\"></div>\n\t\t\t</el-form-item>\n\n\t\t\t<el-form-item label=\"点赞数\" prop=\"likes\" style=\"width: 50%\">\n\t\t\t\t<el-input v-model=\"form.likes\" type=\"number\" placeholder=\"可选，默认为 0\"></el-input>\n\t\t\t</el-form-item>\n\n\t\t\t<el-form-item label=\"创建时间\" prop=\"createTime\">\n\t\t\t\t<el-date-picker v-model=\"form.createTime\" type=\"datetime\" placeholder=\"可选，默认此刻\" :editable=\"false\"></el-date-picker>\n\t\t\t</el-form-item>\n\n\t\t\t<el-form-item style=\"text-align: right;\">\n\t\t\t\t<el-button type=\"info\" @click=\"submit(false)\">保存草稿</el-button>\n\t\t\t\t<el-button type=\"primary\" @click=\"submit(true)\">发布动态</el-button>\n\t\t\t</el-form-item>\n\t\t</el-form>\n\t</div>\n</template>\n\n<script>\n\timport Breadcrumb from \"@/components/Breadcrumb\";\n\timport {getMomentById, saveMoment, updateMoment} from \"@/api/moment\";\n\timport Vditor from 'vditor'\n\n\texport default {\n\t\tname: \"WriteMoment\",\n\t\tcomponents: {Breadcrumb},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tvditor: null,\n\t\t\t\tform: {\n\t\t\t\t\tcontent: '',\n\t\t\t\t\tcreateTime: null,\n\t\t\t\t\tlikes: 0,\n\t\t\t\t\tpublished: false\n\t\t\t\t},\n\t\t\t}\n\t\t},\n\t\tmounted() {\n\t\t\tthis.initVditor()\n\t\t},\n\t\tmethods: {\n\t\t\tinitVditor() {\n\t\t\t\tconst options = {\n\t\t\t\t\theight: 320,\n\t\t\t\t\tmode: 'sv',//分屏渲染\n\t\t\t\t\toutline: false,//大纲\n\t\t\t\t\tcache: {//不缓存到localStorage\n\t\t\t\t\t\tenable: false,\n\t\t\t\t\t},\n\t\t\t\t\tresize: {//可调整高度\n\t\t\t\t\t\tenable: true\n\t\t\t\t\t},\n\t\t\t\t\tafter: () => {\n\t\t\t\t\t\tif (this.$route.params.id) {\n\t\t\t\t\t\t\tthis.getMoment(this.$route.params.id)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.vditor = new Vditor('vditor', options)\n\t\t\t},\n\t\t\tgetMoment(id) {\n\t\t\t\tgetMomentById(id).then(res => {\n\t\t\t\t\tif (res.code === 200) {\n\t\t\t\t\t\tthis.form = res.data\n\t\t\t\t\t\tthis.vditor.setValue(this.form.content)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.msgError(res.msg)\n\t\t\t\t\t}\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tthis.msgError(\"请求失败\")\n\t\t\t\t})\n\t\t\t},\n\t\t\tsubmit(published) {\n\t\t\t\tthis.form.content = this.vditor.getValue()\n\t\t\t\tthis.form.published = published\n\t\t\t\tif (this.$route.params.id) {\n\t\t\t\t\tupdateMoment(this.form).then(res => {\n\t\t\t\t\t\tif (res.code === 200) {\n\t\t\t\t\t\t\tthis.msgSuccess(res.msg)\n\t\t\t\t\t\t\tthis.$router.push('/moments')\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.msgError(res.msg)\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch(() => {\n\t\t\t\t\t\tthis.msgError('请求失败')\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\tsaveMoment(this.form).then(res => {\n\t\t\t\t\t\tif (res.code === 200) {\n\t\t\t\t\t\t\tthis.msgSuccess(res.msg)\n\t\t\t\t\t\t\tthis.$router.push('/moments')\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.msgError(res.msg)\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch(() => {\n\t\t\t\t\t\tthis.msgError('请求失败')\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style scoped>\n\n</style>"]}]}