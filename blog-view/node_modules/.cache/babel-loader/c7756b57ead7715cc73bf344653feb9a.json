{"remainingRequest":"/Users/cm/Blog/blog-view/node_modules/babel-loader/lib/index.js!/Users/cm/Blog/blog-view/src/store/actions.js","dependencies":[{"path":"/Users/cm/Blog/blog-view/src/store/actions.js","mtime":1683690398292},{"path":"/Users/cm/Blog/blog-view/node_modules/cache-loader/dist/cjs.js","mtime":1683698965703},{"path":"/Users/cm/Blog/blog-view/node_modules/babel-loader/lib/index.js","mtime":1683698965965}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5jb25zdHJ1Y3RvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gIi9Vc2Vycy9jbS9CbG9nL2Jsb2ctdmlldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7CmltcG9ydCB7IFNBVkVfQ09NTUVOVF9SRVNVTFQsIFNFVF9QQVJFTlRfQ09NTUVOVF9JRCwgUkVTRVRfQ09NTUVOVF9GT1JNLCBTRVRfQkxPR19QQVNTV09SRF9ESUFMT0dfVklTSUJMRSwgU0VUX0JMT0dfUEFTU1dPUkRfRk9STSB9IGZyb20gIi4vbXV0YXRpb25zLXR5cGVzIjsKaW1wb3J0IHsgZ2V0Q29tbWVudExpc3RCeVF1ZXJ5LCBzdWJtaXRDb21tZW50IH0gZnJvbSAiQC9hcGkvY29tbWVudCI7CmltcG9ydCB7IE1lc3NhZ2UsIE5vdGlmaWNhdGlvbiB9IGZyb20gImVsZW1lbnQtdWkiOwppbXBvcnQgcm91dGVyIGZyb20gIi4uL3JvdXRlciI7CmltcG9ydCB0dk1hcHBlciBmcm9tICdAL3BsdWdpbnMvdHZNYXBwZXIuanNvbic7CmltcG9ydCBhcnVNYXBwZXIgZnJvbSAnQC9wbHVnaW5zL2FydU1hcHBlci5qc29uJzsKaW1wb3J0IHBhb3Bhb01hcHBlciBmcm9tICdAL3BsdWdpbnMvcGFvcGFvTWFwcGVyLmpzb24nOwppbXBvcnQgc2FuaXRpemVIdG1sIGZyb20gJ3Nhbml0aXplLWh0bWwnOwpleHBvcnQgZGVmYXVsdCB7CiAgZ2V0Q29tbWVudExpc3Q6IGZ1bmN0aW9uIGdldENvbW1lbnRMaXN0KF9yZWYpIHsKICAgIHZhciBjb21taXQgPSBfcmVmLmNvbW1pdCwKICAgICAgICByb290U3RhdGUgPSBfcmVmLnJvb3RTdGF0ZTsKICAgIC8v5a+G56CB5L+d5oqk55qE5paH56ug77yM6ZyA6KaB5Y+R6YCB5a+G56CB6aqM6K+B6YCa6L+H5ZCO5L+d5a2Y5ZyobG9jYWxTdG9yYWdl55qEVG9rZW4KICAgIHZhciBibG9nVG9rZW4gPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oImJsb2ciLmNvbmNhdChyb290U3RhdGUuY29tbWVudFF1ZXJ5LmJsb2dJZCkpOyAvL+WmguaenOacieWImeWPkemAgeWNmuS4u+i6q+S7vVRva2VuCgogICAgdmFyIGFkbWluVG9rZW4gPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FkbWluVG9rZW4nKTsKICAgIHZhciB0b2tlbiA9IGFkbWluVG9rZW4gPyBhZG1pblRva2VuIDogYmxvZ1Rva2VuID8gYmxvZ1Rva2VuIDogJyc7CgogICAgZnVuY3Rpb24gcmVwbGFjZUVtb2ppKGNvbW1lbnQsIGVtb2ppKSB7CiAgICAgIGNvbW1lbnQuY29udGVudCA9IGNvbW1lbnQuY29udGVudC5yZXBsYWNlKG5ldyBSZWdFeHAoZW1vamkucmVnLCAnZycpLCAiPGltZyBzcmM9XCIiLmNvbmNhdChlbW9qaS5zcmMsICJcIj4iKSk7CiAgICB9CgogICAgZnVuY3Rpb24gY29udmVydEVtb2ppKGNvbW1lbnQpIHsKICAgICAgdHZNYXBwZXIuZm9yRWFjaChmdW5jdGlvbiAoZW1vamkpIHsKICAgICAgICByZXBsYWNlRW1vamkoY29tbWVudCwgZW1vamkpOwogICAgICB9KTsKICAgICAgYXJ1TWFwcGVyLmZvckVhY2goZnVuY3Rpb24gKGVtb2ppKSB7CiAgICAgICAgcmVwbGFjZUVtb2ppKGNvbW1lbnQsIGVtb2ppKTsKICAgICAgfSk7CiAgICAgIHBhb3Bhb01hcHBlci5mb3JFYWNoKGZ1bmN0aW9uIChlbW9qaSkgewogICAgICAgIHJlcGxhY2VFbW9qaShjb21tZW50LCBlbW9qaSk7CiAgICAgIH0pOwogICAgfQoKICAgIGdldENvbW1lbnRMaXN0QnlRdWVyeSh0b2tlbiwgcm9vdFN0YXRlLmNvbW1lbnRRdWVyeSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgIGlmIChyZXMuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgdmFyIHNhbml0aXplSHRtbENvbmZpZyA9IHsKICAgICAgICAgIGFsbG93ZWRUYWdzOiBbXSwKICAgICAgICAgIGFsbG93ZWRBdHRyaWJ1dGVzOiBmYWxzZSwKICAgICAgICAgIGRpc2FsbG93ZWRUYWdzTW9kZTogJ3JlY3Vyc2l2ZUVzY2FwZScKICAgICAgICB9OwogICAgICAgIHJlcy5kYXRhLmNvbW1lbnRzLmxpc3QuZm9yRWFjaChmdW5jdGlvbiAoY29tbWVudCkgewogICAgICAgICAgLy/ovazkuYnor4TorrrkuK3nmoRodG1sCiAgICAgICAgICBjb21tZW50LmNvbnRlbnQgPSBzYW5pdGl6ZUh0bWwoY29tbWVudC5jb250ZW50LCBzYW5pdGl6ZUh0bWxDb25maWcpOyAvL+afpeaJvuivhOiuuuS4reaYr+WQpuacieihqOaDhQoKICAgICAgICAgIGlmIChjb21tZW50LmNvbnRlbnQuaW5kZXhPZignQFsnKSAhPSAtMSkgewogICAgICAgICAgICBjb252ZXJ0RW1vamkoY29tbWVudCk7CiAgICAgICAgICB9CgogICAgICAgICAgY29tbWVudC5yZXBseUNvbW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGNvbW1lbnQpIHsKICAgICAgICAgICAgLy/ovazkuYnor4TorrrkuK3nmoRodG1sCiAgICAgICAgICAgIGNvbW1lbnQuY29udGVudCA9IHNhbml0aXplSHRtbChjb21tZW50LmNvbnRlbnQsIHNhbml0aXplSHRtbENvbmZpZyk7IC8v5p+l5om+6K+E6K665Lit5piv5ZCm5pyJ6KGo5oOFCgogICAgICAgICAgICBpZiAoY29tbWVudC5jb250ZW50LmluZGV4T2YoJ0BbJykgIT0gLTEpIHsKICAgICAgICAgICAgICBjb252ZXJ0RW1vamkoY29tbWVudCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIGNvbW1pdChTQVZFX0NPTU1FTlRfUkVTVUxULCByZXMuZGF0YSk7CiAgICAgIH0KICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgTWVzc2FnZS5lcnJvcigi6K+35rGC5aSx6LSlIik7CiAgICB9KTsKICB9LAogIHN1Ym1pdENvbW1lbnRGb3JtOiBmdW5jdGlvbiBzdWJtaXRDb21tZW50Rm9ybShfcmVmMiwgdG9rZW4pIHsKICAgIHZhciByb290U3RhdGUgPSBfcmVmMi5yb290U3RhdGUsCiAgICAgICAgZGlzcGF0Y2ggPSBfcmVmMi5kaXNwYXRjaCwKICAgICAgICBjb21taXQgPSBfcmVmMi5jb21taXQ7CgogICAgdmFyIGZvcm0gPSBfb2JqZWN0U3ByZWFkKHt9LCByb290U3RhdGUuY29tbWVudEZvcm0pOwoKICAgIGZvcm0ucGFnZSA9IHJvb3RTdGF0ZS5jb21tZW50UXVlcnkucGFnZTsKICAgIGZvcm0uYmxvZ0lkID0gcm9vdFN0YXRlLmNvbW1lbnRRdWVyeS5ibG9nSWQ7CiAgICBmb3JtLnBhcmVudENvbW1lbnRJZCA9IHJvb3RTdGF0ZS5wYXJlbnRDb21tZW50SWQ7CiAgICBzdWJtaXRDb21tZW50KHRva2VuLCBmb3JtKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgaWYgKHJlcy5jb2RlID09PSAyMDApIHsKICAgICAgICBOb3RpZmljYXRpb24oewogICAgICAgICAgdGl0bGU6IHJlcy5tc2csCiAgICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgICB9KTsKICAgICAgICBjb21taXQoU0VUX1BBUkVOVF9DT01NRU5UX0lELCAtMSk7CiAgICAgICAgY29tbWl0KFJFU0VUX0NPTU1FTlRfRk9STSk7CiAgICAgICAgZGlzcGF0Y2goJ2dldENvbW1lbnRMaXN0Jyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgTm90aWZpY2F0aW9uKHsKICAgICAgICAgIHRpdGxlOiAn6K+E6K665aSx6LSlJywKICAgICAgICAgIG1lc3NhZ2U6IHJlcy5tc2csCiAgICAgICAgICB0eXBlOiAnZXJyb3InCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgTm90aWZpY2F0aW9uKHsKICAgICAgICB0aXRsZTogJ+ivhOiuuuWksei0pScsCiAgICAgICAgbWVzc2FnZTogJ+W8guW4uOmUmeivrycsCiAgICAgICAgdHlwZTogJ2Vycm9yJwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgZ29CbG9nUGFnZTogZnVuY3Rpb24gZ29CbG9nUGFnZShfcmVmMywgYmxvZykgewogICAgdmFyIGNvbW1pdCA9IF9yZWYzLmNvbW1pdDsKCiAgICBpZiAoYmxvZy5wcml2YWN5KSB7CiAgICAgIHZhciBhZG1pblRva2VuID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhZG1pblRva2VuJyk7CiAgICAgIHZhciBibG9nVG9rZW4gPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oImJsb2ciLmNvbmNhdChibG9nLmlkKSk7IC8v5a+55LqO5a+G56CB5L+d5oqk5paH56ug77yM5Y2a5Li76Lqr5Lu9VG9rZW7lkoznu4/ov4flr4bnoIHpqozor4HlkI7nmoRUb2tlbumDveWPr+S7pei3s+i9rOi3r+eUse+8jOWGjeeUseWQjuerr+mqjOivgVRva2Vu5pyJ5pWI5oCnCgogICAgICBpZiAoYWRtaW5Ub2tlbiB8fCBibG9nVG9rZW4pIHsKICAgICAgICByZXR1cm4gcm91dGVyLnB1c2goIi9ibG9nLyIuY29uY2F0KGJsb2cuaWQpKTsKICAgICAgfQoKICAgICAgY29tbWl0KFNFVF9CTE9HX1BBU1NXT1JEX0ZPUk0sIHsKICAgICAgICBibG9nSWQ6IGJsb2cuaWQsCiAgICAgICAgcGFzc3dvcmQ6ICcnCiAgICAgIH0pOwogICAgICBjb21taXQoU0VUX0JMT0dfUEFTU1dPUkRfRElBTE9HX1ZJU0lCTEUsIHRydWUpOwogICAgfSBlbHNlIHsKICAgICAgcm91dGVyLnB1c2goIi9ibG9nLyIuY29uY2F0KGJsb2cuaWQpKTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["/Users/cm/Blog/blog-view/src/store/actions.js"],"names":["SAVE_COMMENT_RESULT","SET_PARENT_COMMENT_ID","RESET_COMMENT_FORM","SET_BLOG_PASSWORD_DIALOG_VISIBLE","SET_BLOG_PASSWORD_FORM","getCommentListByQuery","submitComment","Message","Notification","router","tvMapper","aruMapper","paopaoMapper","sanitizeHtml","getCommentList","commit","rootState","blogToken","window","localStorage","getItem","commentQuery","blogId","adminToken","token","replaceEmoji","comment","emoji","content","replace","RegExp","reg","src","convertEmoji","forEach","then","res","code","sanitizeHtmlConfig","allowedTags","allowedAttributes","disallowedTagsMode","data","comments","list","indexOf","replyComments","catch","error","submitCommentForm","dispatch","form","commentForm","page","parentCommentId","title","msg","type","message","goBlogPage","blog","privacy","id","push","password"],"mappings":"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","sourcesContent":["import {\n\tSAVE_COMMENT_RESULT,\n\tSET_PARENT_COMMENT_ID,\n\tRESET_COMMENT_FORM,\n\tSET_BLOG_PASSWORD_DIALOG_VISIBLE,\n\tSET_BLOG_PASSWORD_FORM\n} from \"./mutations-types\";\n\nimport {getCommentListByQuery, submitComment} from \"@/api/comment\";\nimport {Message, Notification} from \"element-ui\";\nimport router from \"../router\";\nimport tvMapper from '@/plugins/tvMapper.json'\nimport aruMapper from '@/plugins/aruMapper.json'\nimport paopaoMapper from '@/plugins/paopaoMapper.json'\nimport sanitizeHtml from 'sanitize-html'\n\nexport default {\n\tgetCommentList({commit, rootState}) {\n\t\t//密码保护的文章，需要发送密码验证通过后保存在localStorage的Token\n\t\tconst blogToken = window.localStorage.getItem(`blog${rootState.commentQuery.blogId}`)\n\t\t//如果有则发送博主身份Token\n\t\tconst adminToken = window.localStorage.getItem('adminToken')\n\t\tconst token = adminToken ? adminToken : (blogToken ? blogToken : '')\n\n\t\tfunction replaceEmoji(comment, emoji) {\n\t\t\tcomment.content = comment.content.replace(new RegExp(emoji.reg, 'g'), `<img src=\"${emoji.src}\">`)\n\t\t}\n\n\t\tfunction convertEmoji(comment) {\n\t\t\ttvMapper.forEach(emoji => {\n\t\t\t\treplaceEmoji(comment, emoji)\n\t\t\t})\n\t\t\taruMapper.forEach(emoji => {\n\t\t\t\treplaceEmoji(comment, emoji)\n\t\t\t})\n\t\t\tpaopaoMapper.forEach(emoji => {\n\t\t\t\treplaceEmoji(comment, emoji)\n\t\t\t})\n\t\t}\n\n\t\tgetCommentListByQuery(token, rootState.commentQuery).then(res => {\n\t\t\tif (res.code === 200) {\n\t\t\t\tlet sanitizeHtmlConfig = {\n\t\t\t\t\tallowedTags: [],\n\t\t\t\t\tallowedAttributes: false,\n\t\t\t\t\tdisallowedTagsMode: 'recursiveEscape'\n\t\t\t\t}\n\t\t\t\tres.data.comments.list.forEach(comment => {\n\t\t\t\t\t//转义评论中的html\n\t\t\t\t\tcomment.content = sanitizeHtml(comment.content, sanitizeHtmlConfig)\n\t\t\t\t\t//查找评论中是否有表情\n\t\t\t\t\tif (comment.content.indexOf('@[') != -1) {\n\t\t\t\t\t\tconvertEmoji(comment)\n\t\t\t\t\t}\n\t\t\t\t\tcomment.replyComments.forEach(comment => {\n\t\t\t\t\t\t//转义评论中的html\n\t\t\t\t\t\tcomment.content = sanitizeHtml(comment.content, sanitizeHtmlConfig)\n\t\t\t\t\t\t//查找评论中是否有表情\n\t\t\t\t\t\tif (comment.content.indexOf('@[') != -1) {\n\t\t\t\t\t\t\tconvertEmoji(comment)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\tcommit(SAVE_COMMENT_RESULT, res.data)\n\t\t\t}\n\t\t}).catch(() => {\n\t\t\tMessage.error(\"请求失败\")\n\t\t})\n\t},\n\tsubmitCommentForm({rootState, dispatch, commit}, token) {\n\t\tlet form = {...rootState.commentForm}\n\t\tform.page = rootState.commentQuery.page\n\t\tform.blogId = rootState.commentQuery.blogId\n\t\tform.parentCommentId = rootState.parentCommentId\n\t\tsubmitComment(token, form).then(res => {\n\t\t\tif (res.code === 200) {\n\t\t\t\tNotification({\n\t\t\t\t\ttitle: res.msg,\n\t\t\t\t\ttype: 'success'\n\t\t\t\t})\n\t\t\t\tcommit(SET_PARENT_COMMENT_ID, -1)\n\t\t\t\tcommit(RESET_COMMENT_FORM)\n\t\t\t\tdispatch('getCommentList')\n\t\t\t} else {\n\t\t\t\tNotification({\n\t\t\t\t\ttitle: '评论失败',\n\t\t\t\t\tmessage: res.msg,\n\t\t\t\t\ttype: 'error'\n\t\t\t\t})\n\t\t\t}\n\t\t}).catch(() => {\n\t\t\tNotification({\n\t\t\t\ttitle: '评论失败',\n\t\t\t\tmessage: '异常错误',\n\t\t\t\ttype: 'error'\n\t\t\t})\n\t\t})\n\t},\n\tgoBlogPage({commit}, blog) {\n\t\tif (blog.privacy) {\n\t\t\tconst adminToken = window.localStorage.getItem('adminToken')\n\t\t\tconst blogToken = window.localStorage.getItem(`blog${blog.id}`)\n\t\t\t//对于密码保护文章，博主身份Token和经过密码验证后的Token都可以跳转路由，再由后端验证Token有效性\n\t\t\tif (adminToken || blogToken) {\n\t\t\t\treturn router.push(`/blog/${blog.id}`)\n\t\t\t}\n\t\t\tcommit(SET_BLOG_PASSWORD_FORM, {blogId: blog.id, password: ''})\n\t\t\tcommit(SET_BLOG_PASSWORD_DIALOG_VISIBLE, true)\n\t\t} else {\n\t\t\trouter.push(`/blog/${blog.id}`)\n\t\t}\n\t},\n}"]}]}