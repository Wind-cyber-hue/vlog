{"remainingRequest":"/Users/cm/Blog/blog-view/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/cm/Blog/blog-view/src/views/moments/Moments.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/cm/Blog/blog-view/src/views/moments/Moments.vue","mtime":1683690398309},{"path":"/Users/cm/Blog/blog-view/node_modules/cache-loader/dist/cjs.js","mtime":1686729283471},{"path":"/Users/cm/Blog/blog-view/node_modules/babel-loader/lib/index.js","mtime":1686729283156},{"path":"/Users/cm/Blog/blog-view/node_modules/cache-loader/dist/cjs.js","mtime":1686729283471},{"path":"/Users/cm/Blog/blog-view/node_modules/vue-loader/lib/index.js","mtime":1686729286819}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7Z2V0TW9tZW50TGlzdEJ5UGFnZU51bSwgbGlrZU1vbWVudH0gZnJvbSAiQC9hcGkvbW9tZW50IjsKCmV4cG9ydCBkZWZhdWx0IHsKCW5hbWU6ICJNb21lbnRzIiwKCWRhdGEoKSB7CgkJcmV0dXJuIHsKCQkJLy/nlKhsb2NhbFN0b3JhZ2XmnKzlnLDlrZjlgqjlt7LngrnotZ7nmoTliqjmgIFpZOaVsOe7hAoJCQlsaWtlTW9tZW50SWRzOiBKU09OLnBhcnNlKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbGlrZU1vbWVudElkcycpIHx8ICdbXScpLAoJCQltb21lbnRMaXN0OiBbXSwKCQkJcGFnZU51bTogMSwKCQkJdG90YWxQYWdlOiAwCgkJfQoJfSwKCWNyZWF0ZWQoKSB7CgkJdGhpcy5nZXRNb21lbnRMaXN0KCkKCX0sCgljb21wdXRlZDogewoJCWlzTGlrZSgpIHsKCQkJcmV0dXJuIGZ1bmN0aW9uIChpZCkgewoJCQkJcmV0dXJuIHRoaXMubGlrZU1vbWVudElkcy5pbmRleE9mKGlkKSA+IC0xCgkJCX0KCQl9Cgl9LAoJd2F0Y2g6IHsKCQlsaWtlTW9tZW50SWRzKG5ld1ZhbHVlKSB7CgkJCS8v5bCGbGlrZU1vbWVudElkc+acgOaWsOWAvOeahGpzb27mlbDmja7kv53lrZjliLBsb2NhbFN0b3JhZ2UKCQkJd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdsaWtlTW9tZW50SWRzJywgSlNPTi5zdHJpbmdpZnkobmV3VmFsdWUpKQoJCX0KCX0sCgltZXRob2RzOiB7CgkJZ2V0TW9tZW50TGlzdCgpIHsKCQkJLy/lpoLmnpzmnInliJnlj5HpgIHljZrkuLvouqvku71Ub2tlbgoJCQljb25zdCBhZG1pblRva2VuID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhZG1pblRva2VuJykKCQkJY29uc3QgdG9rZW4gPSBhZG1pblRva2VuID8gYWRtaW5Ub2tlbiA6ICcnCgkJCWdldE1vbWVudExpc3RCeVBhZ2VOdW0odG9rZW4sIHRoaXMucGFnZU51bSkudGhlbihyZXMgPT4gewoJCQkJaWYgKHJlcy5jb2RlID09PSAyMDApIHsKCQkJCQl0aGlzLm1vbWVudExpc3QgPSByZXMuZGF0YS5saXN0CgkJCQkJdGhpcy50b3RhbFBhZ2UgPSByZXMuZGF0YS50b3RhbFBhZ2UKCQkJCX0gZWxzZSB7CgkJCQkJdGhpcy5tc2dFcnJvcihyZXMubXNnKQoJCQkJfQoJCQl9KS5jYXRjaCgoKSA9PiB7CgkJCQl0aGlzLm1zZ0Vycm9yKCLor7fmsYLlpLHotKUiKQoJCQl9KQoJCX0sCgkJaGFuZGxlQ3VycmVudENoYW5nZShuZXdQYWdlKSB7CgkJCXRoaXMuc2Nyb2xsVG9Ub3AoKQoJCQl0aGlzLnBhZ2VOdW0gPSBuZXdQYWdlCgkJCXRoaXMuZ2V0TW9tZW50TGlzdCgpCgkJfSwKCQlsaWtlKGlkKSB7CgkJCWlmICh0aGlzLmxpa2VNb21lbnRJZHMuaW5kZXhPZihpZCkgPiAtMSkgewoJCQkJdGhpcy4kbm90aWZ5KHsKCQkJCQl0aXRsZTogJ+S4jeWPr+S7pemHjeWkjeeCuei1nuWTpicsCgkJCQkJdHlwZTogJ3dhcm5pbmcnCgkJCQl9KQoJCQkJcmV0dXJuCgkJCX0KCQkJbGlrZU1vbWVudChpZCkudGhlbihyZXMgPT4gewoJCQkJaWYgKHJlcy5jb2RlID09PSAyMDApIHsKCQkJCQl0aGlzLiRub3RpZnkoewoJCQkJCQl0aXRsZTogcmVzLm1zZywKCQkJCQkJdHlwZTogJ3N1Y2Nlc3MnCgkJCQkJfSkKCQkJCQl0aGlzLmxpa2VNb21lbnRJZHMucHVzaChpZCkKCQkJCQl0aGlzLm1vbWVudExpc3QuZm9yRWFjaChpdGVtID0+IHsKCQkJCQkJaWYgKGl0ZW0uaWQgPT09IGlkKSB7CgkJCQkJCQlyZXR1cm4gaXRlbS5saWtlcysrCgkJCQkJCX0KCQkJCQl9KQoJCQkJfSBlbHNlIHsKCQkJCQl0aGlzLiRub3RpZnkoewoJCQkJCQl0aXRsZTogcmVzLm1zZywKCQkJCQkJdHlwZTogJ3dhcm5pbmcnCgkJCQkJfSkKCQkJCX0KCQkJfSkuY2F0Y2goKCkgPT4gewoJCQkJdGhpcy4kbm90aWZ5KHsKCQkJCQl0aXRsZTogJ+W8guW4uOmUmeivrycsCgkJCQkJdHlwZTogJ2Vycm9yJwoJCQkJfSkKCQkJfSkKCQl9Cgl9Cn0K"},{"version":3,"sources":["Moments.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Moments.vue","sourceRoot":"src/views/moments","sourcesContent":["<template>\n\t<div>\n\t\t<div class=\"ui top attached segment\" style=\"text-align: center\">\n\t\t\t<h2 class=\"m-text-500\">我的动态</h2>\n\t\t</div>\n\t\t<div class=\"ui attached segment m-padding-bottom-large\">\n\t\t\t<div class=\"moments\">\n\t\t\t\t<div class=\"moment\" v-for=\"(moment,index) in momentList\" :key=\"index\">\n\t\t\t\t\t<div class=\"avatar\">\n\t\t\t\t\t\t<img :src=\"$store.state.introduction.avatar\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui card\">\n\t\t\t\t\t\t<div class=\"content m-top\">\n\t\t\t\t\t\t\t<span style=\"font-weight: 700\">{{ $store.state.introduction.name }}</span>\n\t\t\t\t\t\t\t<span class=\"right floated\">{{ moment.createTime | dateFromNow }}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"content typo\" :class=\"{'privacy':!moment.published}\" v-viewer v-html=\"moment.content\"></div>\n\t\t\t\t\t\t<div class=\"extra content\">\n\t\t\t\t\t\t\t<a class=\"left floated\" @click=\"like(moment.id)\">\n\t\t\t\t\t\t\t\t<i class=\"heart icon\" :class=\"isLike(moment.id)?'like-color':'outline'\"></i>{{ moment.likes }}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<el-pagination @current-change=\"handleCurrentChange\" :current-page=\"pageNum\" :page-count=\"totalPage\"\n\t\t\t               layout=\"prev, pager, next\" background hide-on-single-page class=\"pagination\">\n\t\t\t</el-pagination>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\n\timport {getMomentListByPageNum, likeMoment} from \"@/api/moment\";\n\n\texport default {\n\t\tname: \"Moments\",\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\t//用localStorage本地存储已点赞的动态id数组\n\t\t\t\tlikeMomentIds: JSON.parse(window.localStorage.getItem('likeMomentIds') || '[]'),\n\t\t\t\tmomentList: [],\n\t\t\t\tpageNum: 1,\n\t\t\t\ttotalPage: 0\n\t\t\t}\n\t\t},\n\t\tcreated() {\n\t\t\tthis.getMomentList()\n\t\t},\n\t\tcomputed: {\n\t\t\tisLike() {\n\t\t\t\treturn function (id) {\n\t\t\t\t\treturn this.likeMomentIds.indexOf(id) > -1\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\twatch: {\n\t\t\tlikeMomentIds(newValue) {\n\t\t\t\t//将likeMomentIds最新值的json数据保存到localStorage\n\t\t\t\twindow.localStorage.setItem('likeMomentIds', JSON.stringify(newValue))\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\tgetMomentList() {\n\t\t\t\t//如果有则发送博主身份Token\n\t\t\t\tconst adminToken = window.localStorage.getItem('adminToken')\n\t\t\t\tconst token = adminToken ? adminToken : ''\n\t\t\t\tgetMomentListByPageNum(token, this.pageNum).then(res => {\n\t\t\t\t\tif (res.code === 200) {\n\t\t\t\t\t\tthis.momentList = res.data.list\n\t\t\t\t\t\tthis.totalPage = res.data.totalPage\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.msgError(res.msg)\n\t\t\t\t\t}\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tthis.msgError(\"请求失败\")\n\t\t\t\t})\n\t\t\t},\n\t\t\thandleCurrentChange(newPage) {\n\t\t\t\tthis.scrollToTop()\n\t\t\t\tthis.pageNum = newPage\n\t\t\t\tthis.getMomentList()\n\t\t\t},\n\t\t\tlike(id) {\n\t\t\t\tif (this.likeMomentIds.indexOf(id) > -1) {\n\t\t\t\t\tthis.$notify({\n\t\t\t\t\t\ttitle: '不可以重复点赞哦',\n\t\t\t\t\t\ttype: 'warning'\n\t\t\t\t\t})\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tlikeMoment(id).then(res => {\n\t\t\t\t\tif (res.code === 200) {\n\t\t\t\t\t\tthis.$notify({\n\t\t\t\t\t\t\ttitle: res.msg,\n\t\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t\t})\n\t\t\t\t\t\tthis.likeMomentIds.push(id)\n\t\t\t\t\t\tthis.momentList.forEach(item => {\n\t\t\t\t\t\t\tif (item.id === id) {\n\t\t\t\t\t\t\t\treturn item.likes++\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.$notify({\n\t\t\t\t\t\t\ttitle: res.msg,\n\t\t\t\t\t\t\ttype: 'warning'\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tthis.$notify({\n\t\t\t\t\t\ttitle: '异常错误',\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style scoped>\n\t.avatar {\n\t\tmargin-left: -62.5px;\n\t\tfloat: left !important;\n\t}\n\n\t.avatar img {\n\t\theight: 45px;\n\t\twidth: 45px;\n\t\tborder-radius: 500px;\n\t}\n\n\t.moments {\n\t\tmargin-left: 26px !important;\n\t\tpadding-left: 40px !important;\n\t\tborder-left: 1px solid #dee5e7 !important;\n\t}\n\n\t.moment {\n\t\tmargin-top: 30px;\n\t}\n\n\t.moment:first-child {\n\t\tmargin-top: 0 !important;\n\t}\n\n\t.card {\n\t\twidth: 100% !important;\n\t}\n\n\t.card:before {\n\t\tborder-width: 0 0 1px 1px !important;\n\t\ttransform: translateX(-50%) translateY(-50%) rotate(45deg) !important;\n\t\tbottom: auto !important;\n\t\tright: auto !important;\n\t\ttop: 22px !important;\n\t\tleft: 0 !important;\n\t\tposition: absolute !important;\n\t\tcontent: '' !important;\n\t\tbackground-image: none !important;\n\t\tz-index: 2 !important;\n\t\twidth: 12px !important;\n\t\theight: 12px !important;\n\t\ttransition: background .1s ease !important;\n\t\tbackground-color: inherit !important;\n\t\tborder-style: solid !important;\n\t\tborder-color: #d4d4d5 !important;\n\t}\n\n\t.content.m-top {\n\t\tpadding: 10px 14px !important;\n\t}\n\n\t.content .right.floated {\n\t\tfont-size: 12px !important;\n\t}\n\n\t.content.typo * {\n\t\tfont-size: 14px !important;\n\t}\n\n\t.extra.content {\n\t\tpadding: 5px 14px !important;\n\t}\n\n\t.extra.content a {\n\t\tcolor: rgba(0, 0, 0, 0.7) !important;\n\t\tfont-size: 12px !important;\n\t}\n\n\t.extra.content a:hover {\n\t\tcolor: red !important;\n\t}\n\n\t.extra.content .like-color {\n\t\tcolor: red !important;\n\t}\n\n\t.extra.content i {\n\t\tfont-size: 12px !important;\n\t}\n\n\t.pagination {\n\t\ttext-align: center;\n\t\tmargin-top: 3em;\n\t}\n\n\t.privacy {\n\t\tbackground: repeating-linear-gradient(145deg, #f2f2f2, #f2f2f2 15px, #fff 0, #fff 30px) !important;\n\t}\n</style>"]}]}